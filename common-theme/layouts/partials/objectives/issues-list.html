{{/* This partial belongs to the sprint success page */}}
{{ $repo := .backlog }}
{{ $filter := .backlog_filter }}
{{ $issuesUrl := print site.Params.orgapi $repo "/issues?per_page=100&state=open&direction=asc" }}
{{ $headers := partial "github-auth.html" }}

{{ with resources.GetRemote $issuesUrl $headers }}
  {{ with .Content }}
    {{ if eq . "[]" }}
      {{ warnf "No issues found at %s" $issuesUrl }}
    {{ else }}
      {{ $issues := . | unmarshal }}
      {{/* <!-- range over issues list and pull out title and objectives only --> */}}
      {{ range $issues }}
        {{ $showIssue := true }}
        {{/* <!-- if a filter exists, only show issues with the right label --> */}}
        {{ if $filter }}
          {{ $showIssue = false }}
          {{ range .labels }}
            {{ if in .name
              $filter
            }}
              {{ $showIssue = true }}
            {{ end }}
          {{ end }}
        {{ end }}

        {{ if (isset . "pull_request") }}
          {{ $showIssue = false }}
        {{ end }}
        <!-- now show the issue -->

        {{ $extractedObjectives := partial "strings/extract-github-objectives.html" . }}
        {{ if gt (len $extractedObjectives) 0 }}
          <h5>{{ .title }}</h5>
          {{ range $extractedObjectives }}
            {{ . | markdownify }}
          {{ end }}
        {{ end }}
      {{ end }}
    {{ end }}
  {{ end }}
{{ end }}
